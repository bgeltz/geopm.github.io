<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>External Requirements &mdash; GEOPM  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building and Installing" href="build.html" />
    <link rel="prev" title="GEOPM Service" href="service_readme.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> GEOPM
            <img src="https://geopm.github.io/images/geopm-logo-clear.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="service.html">Guide for Service Users</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="service_readme.html">GEOPM Service</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">External Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#build-requirements">Build Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#upstream-rhel-and-centos-package-requirements">Upstream RHEL and CentOS Package Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upstream-sles-and-opensuse-package-requirements">Upstream SLES and OpenSUSE Package Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dasbus-requirement">Dasbus Requirement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#systemd-library-requirement">Systemd Library Requirement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sphinx-requirement">Sphinx Requirement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-requirements">Run Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-msr-driver">The MSR Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="#systemd-configuration">Systemd Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="build.html">Building and Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="admin.html">Guide for Service Administrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html">Guide for Service Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Guide to Service Security</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Guide for HPC Runtime Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Guide for Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="devel.html">Guide for GEOPM Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference Manual</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GEOPM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="service.html">Guide for Service Users</a> &raquo;</li>
      <li>External Requirements</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/requires.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="external-requirements">
<h1>External Requirements<a class="headerlink" href="#external-requirements" title="Permalink to this headline"></a></h1>
<p>There are several external dependencies that GEOPM requires to enable
certain features.  The requirements for the GEOPM Service features are
all provided by commonly used Linux distributions.  A user that is
only interested in using the GEOPM Service will find all of the
dependencies in this page.  A user of the GEOPM HPC Runtime should
refer to the documentation for that feature
<a class="reference external" href="https://geopm.github.io/runtime.html">here</a> to learn
about the external dependencies that the runtime requires.</p>
<section id="build-requirements">
<h2>Build Requirements<a class="headerlink" href="#build-requirements" title="Permalink to this headline"></a></h2>
<p>There are several packages that are required to run the GEOPM service
build.  These packages are available from standard Linux distributions.
The following commands can be used to install them using several RPM
based Linux distributions.</p>
<section id="upstream-rhel-and-centos-package-requirements">
<h3>Upstream RHEL and CentOS Package Requirements<a class="headerlink" href="#upstream-rhel-and-centos-package-requirements" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yum install python3 python3-devel python3-gobject-base <span class="se">\</span>
            python3-Sphinx python3-sphinx_rtd_theme <span class="se">\</span>
            systemd-devel
</pre></div>
</div>
</section>
<section id="upstream-sles-and-opensuse-package-requirements">
<h3>Upstream SLES and OpenSUSE Package Requirements<a class="headerlink" href="#upstream-sles-and-opensuse-package-requirements" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>zypper install python3 python3-devel python3-gobject <span class="se">\</span>
               python3-Sphinx python3-sphinx_rtd_theme <span class="se">\</span>
               systemd-devel
</pre></div>
</div>
</section>
<section id="dasbus-requirement">
<h3>Dasbus Requirement<a class="headerlink" href="#dasbus-requirement" title="Permalink to this headline"></a></h3>
<p>The geopm service requires a more recent version of dasbus than is
currently packaged by Linux distributions (dasbus version 1.5 or more
recent).  The script located in the subdirectory of the geopm repo:</p>
<p><code class="docutils literal notranslate"><span class="pre">service/integration/build_dasbus.sh</span></code></p>
<p>can be executed to create the required RPM based on dasbus version 1.6.
The script will print how to install the generated RPM upon successful
completion.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">python-dasbus</span></code> requirement is explicitly stated in the
geopm-service spec file.  Because of this, an RPM installation of
dasbus is required.  Alternatively, dasbus may be updated with
<code class="docutils literal notranslate"><span class="pre">pip</span></code>, but unless a python-dasbus RPM is installed on the system,
the requirement must be removed from the file
<code class="docutils literal notranslate"><span class="pre">service/geopm-service.spec.in</span></code> in the GEOPM repo before building
the GEOPM service RPMs.</p>
</section>
<section id="systemd-library-requirement">
<h3>Systemd Library Requirement<a class="headerlink" href="#systemd-library-requirement" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">systemd-devel</span></code> package requirement may be omitted if the geopm
service build is configured with the <code class="docutils literal notranslate"><span class="pre">--disable-systemd</span></code> option.
This will be required on older Linux distributions like CentOS 7.  The
effect of disabling use of <code class="docutils literal notranslate"><span class="pre">libsystemd</span></code> is that a user-space loaded
PlatformIO interface will not access signals or controls provided by
the GEOPM Systemd Service.  Providing <code class="docutils literal notranslate"><span class="pre">--disable-systemd</span></code> configure
option will have no impact on the end user of GEOPM unless the GEOPM
Systemd Service is installed and active in the running Linux OS.</p>
</section>
<section id="sphinx-requirement">
<h3>Sphinx Requirement<a class="headerlink" href="#sphinx-requirement" title="Permalink to this headline"></a></h3>
<p>The sphinx python package is used to generate man pages and HTML
documentation.  The generated man pages are required when running the build.
The man pages are included in a distribution tarball created with the
<cite>make dist</cite> target, so building from such an archive does not explicitly require
sphinx.  This requirement may also be satisfied with PIP if installing the RPM
packages for sphinx is an issue on your system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 -m pip install --user sphinx sphinx_rtd_theme
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/.local/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>These commands will install sphinx into your user's local python packages and
add the the local python package bin directory to your path for access to the
sphinx-build script.</p>
</section>
</section>
<section id="run-requirements">
<h2>Run Requirements<a class="headerlink" href="#run-requirements" title="Permalink to this headline"></a></h2>
<p>There are some time-of-use requirements for both the GEOPM Service and
the GEOPM HPC Runtime.  These requirements relate to the MSR driver
and the configuration of systemd.</p>
<p>The use of MSRs enable many important features of the GEOPM Service
for gathering hardware telemetry and setting hardware controls.  The
GEOPM Service will function without access to MSRs, however it will
provide a more restricted set of hardware features.  These MSR related
hardware features are required for the GEOPM HPC Runtime to function
correctly.  For this reason, MSR support is a hard requirement for the
GEOPM HPC Runtime.</p>
<p>There may be some problematic settings for systemd which could lead to
inter-process communication issues for both the GEOPM Service and the
GEOPM HPC Runtime.</p>
<section id="the-msr-driver">
<h3>The MSR Driver<a class="headerlink" href="#the-msr-driver" title="Permalink to this headline"></a></h3>
<p>The msr-safe kernel driver provides two features.  One of these is a
performance feature providing a low latency interface for reading and
writing many MSR values at once through an <cite>ioctl(2)</cite> system call.
This may enable better performance of the GEOPM HPC runtime or other
uses of MSRs, but also may not be critical depending on the
algorithmic requirements.</p>
<p>The other feature that the msr-safe kernel driver provides is
user-level read and write of the model specific registers (MSRs) with
access managed through an allowed list that is controlled by the system
administrator.  This feature is required by the GEOPM runtime if the
GEOPM Service is not active on the system.  Alternately, the access
management for MSRs may be configured by the system administrator
using the GEOPM Service if it is active.</p>
<p>The msr-safe kernel driver is distributed with OpenHPC and can be
installed using the RPMs distributed there.  The source code for the
driver can be found <a class="reference external" href="https://github.com/LLNL/msr-safe">here</a>.</p>
<p>If both the msr-safe kernel driver and the GEOPM Systemd Service are
unavailable, then GEOPM when run by the root user may access MSRs
through the standard msr driver.  This may be loaded with the
following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>modprobe msr
</pre></div>
</div>
<p>The standard msr driver must also be loaded to enable MSR access
through the GEOPM Systemd Service when msr-safe is not installed.</p>
</section>
<section id="systemd-configuration">
<h3>Systemd Configuration<a class="headerlink" href="#systemd-configuration" title="Permalink to this headline"></a></h3>
<p>In order for GEOPM to properly use shared memory to communicate
between the Controller and the application, it may be necessary to
alter the configuration for systemd.  The default behavior of systemd
is to clean-up all inter-process communication for non-system users.
This causes issues with GEOPM's initialization routines for shared
memory.  This can be disabled by ensuring that <cite>RemoveIPC=no</cite> is set
in <cite>/etc/systemd/logind.conf</cite>.  Most Linux distributions change the
default setting to disable this behavior.  More information can be
found <a class="reference external" href="https://superuser.com/a/1179962">here</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="service_readme.html" class="btn btn-neutral float-left" title="GEOPM Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="build.html" class="btn btn-neutral float-right" title="Building and Installing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015 - 2022, Intel Corporation. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>