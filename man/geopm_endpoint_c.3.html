<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='content-type' value='text/html;charset=utf8'>
  <meta name='generator' value='Ronn/v0.7.3 (http://github.com/rtomayko/ronn/tree/0.7.3)'>
  <title>geopm_endpoint_c(3) - dynamic policy control for resource management</title>
  <style type='text/css' media='all'>
  /* style: man */
  body#manpage {margin:0}
  .mp {max-width:100ex;padding:0 9ex 1ex 4ex}
  .mp p,.mp pre,.mp ul,.mp ol,.mp dl {margin:0 0 20px 0}
  .mp h2 {margin:10px 0 0 0}
  .mp > p,.mp > pre,.mp > ul,.mp > ol,.mp > dl {margin-left:8ex}
  .mp h3 {margin:0 0 0 4ex}
  .mp dt {margin:0;clear:left}
  .mp dt.flush {float:left;width:8ex}
  .mp dd {margin:0 0 0 9ex}
  .mp h1,.mp h2,.mp h3,.mp h4 {clear:left}
  .mp pre {margin-bottom:20px}
  .mp pre+h2,.mp pre+h3 {margin-top:22px}
  .mp h2+pre,.mp h3+pre {margin-top:5px}
  .mp img {display:block;margin:auto}
  .mp h1.man-title {display:none}
  .mp,.mp code,.mp pre,.mp tt,.mp kbd,.mp samp,.mp h3,.mp h4 {font-family:monospace;font-size:14px;line-height:1.42857142857143}
  .mp h2 {font-size:16px;line-height:1.25}
  .mp h1 {font-size:20px;line-height:2}
  .mp {text-align:justify;background:#fff}
  .mp,.mp code,.mp pre,.mp pre code,.mp tt,.mp kbd,.mp samp {color:#131211}
  .mp h1,.mp h2,.mp h3,.mp h4 {color:#030201}
  .mp u {text-decoration:underline}
  .mp code,.mp strong,.mp b {font-weight:bold;color:#131211}
  .mp em,.mp var {font-style:italic;color:#232221;text-decoration:none}
  .mp a,.mp a:link,.mp a:hover,.mp a code,.mp a pre,.mp a tt,.mp a kbd,.mp a samp {color:#0000ff}
  .mp b.man-ref {font-weight:normal;color:#434241}
  .mp pre {padding:0 4ex}
  .mp pre code {font-weight:normal;color:#434241}
  .mp h2+pre,h3+pre {padding-left:0}
  ol.man-decor,ol.man-decor li {margin:3px 0 10px 0;padding:0;float:left;width:33%;list-style-type:none;text-transform:uppercase;color:#999;letter-spacing:1px}
  ol.man-decor {width:100%}
  ol.man-decor li.tl {text-align:left}
  ol.man-decor li.tc {text-align:center;letter-spacing:4px}
  ol.man-decor li.tr {text-align:right;float:right}
  </style>
</head>
<!--
  The following styles are deprecated and will be removed at some point:
  div#man, div#man ol.man, div#man ol.head, div#man ol.man.

  The .man-page, .man-decor, .man-head, .man-foot, .man-title, and
  .man-navigation should be used instead.
-->
<body id='manpage'>
  <div class='mp' id='man'>

  <div class='man-navigation' style='display:none'>
    <a href="#NAME">NAME</a>
    <a href="#SYNOPSIS">SYNOPSIS</a>
    <a href="#DESCRIPTION">DESCRIPTION</a>
    <a href="#ERRORS">ERRORS</a>
    <a href="#COPYRIGHT">COPYRIGHT</a>
    <a href="#SEE-ALSO">SEE ALSO</a>
  </div>

  <ol class='man-decor man-head man head'>
    <li class='tl'>geopm_endpoint_c(3)</li>
    <li class='tc'></li>
    <li class='tr'>geopm_endpoint_c(3)</li>
  </ol>

  <h2 id="NAME">NAME</h2>
<p class="man-name">
  <code>geopm_endpoint_c</code> - <span class="man-whatis">dynamic policy control for resource management</span>
</p>

<h2 id="SYNOPSIS">SYNOPSIS</h2>

<p><strong>#include <a href="https://github.com/geopm/geopm/blob/dev/src/geopm_agent.h">&lt;geopm_endpoint.h></a></strong></p>

<p><code>Link with -lgeopmpolicy</code></p>

<dl>
<dt><code>int geopm_endpoint_create(</code></dt><dd><p><code>struct geopm_endpoint_c **</code><em>endpoint</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_destroy(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_shmem_create(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>const char *</code><em>endpoint_name</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_shmem_destroy(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>const char *</code><em>endpoint_name</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_shmem_attach(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>const char *</code><em>endpoint_name</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_agent(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>size_t</code> <em>agent_name_max</em>, <br />
<code>char *</code><em>agent_name</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_num_node(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>int *</code><em>num_node</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_node_name(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>int</code> <em>node_idx</em>, <br />
<code>size_t</code> <em>node_name_max</em>, <br />
<code>char *</code><em>node_name</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_agent_policy(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>const double *</code><em>policy_array</em><code>);</code></p></dd>
<dt><code>int geopm_endpoint_agent_sample(</code></dt><dd><p><code>struct geopm_endpoint_c *</code><em>endpoint</em>, <br />
<code>double *</code><em>sample_array</em>, <br />
<code>double *</code><em>sample_age_sec</em><code>);</code></p></dd>
</dl>


<h2 id="DESCRIPTION">DESCRIPTION</h2>

<p>The <em>geopm_endpoint_c</em> interface can be utilized by a system resource manager
or parallel job scheduler to create, inspect, and destroy a GEOPM endpoint.
These endpoints can also be used to dynamically adjust the policy over the
compute application runtime.</p>

<p>For dynamic control, a daemon can use this interface to create and modify an
inter-process shared memory region on the compute node hosting the root MPI
process of the compute application.  The shared memory region is monitored by
the GEOPM runtime to enforce the policy across the entire MPI job allocation.</p>

<p>The endpoints can also be used to extract sample telemetry from the runtime.
This interface works in concert with the <strong><a class="man-ref" href="geopm_agent_c.3.html">geopm_agent_c<span class="s">(3)</span></a></strong> interface for
inspecting the policy and sample parameters that pertain to the current agent.
One must utilize the agent interface to determine the number of sample
parameters provided by the agent and the number of policy values required by the
agent.</p>

<p>All functions described in this man page return an error code on failure and
zero upon success; see <a href="#ERRORS" title="ERRORS" data-bare-link="true">ERRORS</a> section below for details.</p>

<dl>
<dt><code>geopm_endpoint_create</code>()</dt><dd><p>will create an endpoint object.  This object will hold the necessary state
for interfacing with the shmem regions.  The endpoint is stored in
<em>endpoint</em> and will be used with other functions in this interface.  This
will return zero on success indicating that the <em>endpoint</em> struct can now be
used.  It will return an error code of EEXIST if the shmem regions already
exist. <em>endpoint</em> will also be NULL if an error occurs.</p></dd>
<dt><code>geopm_endpoint_destroy</code>()</dt><dd><p>will release resources associated with <em>endpoint</em>.    This will return zero
on success indicating that the shmem regions were removed.  Otherwise an
error code is returned.  This function will not delete any shmem regions.</p></dd>
<dt><code>geopm_endpoint_shmem_create</code>()</dt><dd><p>will create shmem regions for passing policies to the Agent, and reading
samples from the Agent.  These regions will have a substring of the shmem
key that matches <em>endpoint_name</em>.  These shmem regions are managed by the
endpoint.  This will return zero on success indicating that the shmem
regions were successfully created.  If the shmem key already exists, an
error code of EEXIST is returned.</p></dd>
<dt><code>geopm_endpoint_shmem_destroy</code>()</dt><dd><p>will release shmem regions containing the substring <em>endpoint_name</em>.  This
will additionally send a signal to the agent that the manager is detaching
and no longer requires sample updates.  This will return zero on success
indicating that the shmem regions were removed.  Otherwise an error code is
returned.</p></dd>
<dt><code>geopm_endpoint_agent</code>()</dt><dd><p>checks to see if an agent specified by <em>agent_name</em> has attached to the
<em>endpoint</em>.  The number of bytes reserved for <em>agent_name</em> is specified in
<em>agent_name_max</em>.  Returns zero if the endpoint has an agent attached and
the agent's name can be stored in the <em>agent_name</em> buffer.  Otherwise an
error code is returned.  If no agent has attached, error code
GEOPM_ERROR_NO_AGENT is returned.  If no shmem region has been attached to
the endpoint an error code is returned.</p></dd>
<dt><code>geopm_endpoint_num_node</code>()</dt><dd><p>provides the number of nodes contained within the <em>endpoint</em> in <em>num_node</em>.
Returns zero on success, otherwise an error code is returned.</p></dd>
<dt><code>geopm_endpoint_node_name</code>()</dt><dd><p>provides the hostname of the <em>endpoint</em> managed compute node in
<em>node_name</em>.  The index is specified by <em>node_idx</em>.  The number of bytes
reserved for <em>node_name</em> is specified in <em>node_name_max</em>.  Returns zero on
success, otherwise an error code is returned.</p></dd>
<dt><code>geopm_endpoint_agent_policy</code>()</dt><dd><p>sets the policy values for the agent within <em>endpoint</em> to follow.  These
values provided in <em>policy_array</em> will be consumed by the GEOPM runtime at
the next iteration of the control loop.  Returns zero on success, otherwise
an error code is returned.  Setting NAN for a policy value can be used to
to indicate that the Agent should use an appropriate default value.</p></dd>
<dt><code>geopm_endpoint_agent_sample</code>()</dt><dd><p>provides the sample telemetry from the <em>endpoint</em>'s agent in <em>sample_array</em> and the
amount of time that has passed since the agent last provided an update in
<em>sample_age_sec</em>.  Returns zero on success, otherwise an error code is
returned.</p></dd>
</dl>


<h2 id="ERRORS">ERRORS</h2>

<p>All functions described on this man page return an error code.  See
<strong><a class="man-ref" href="geopm_error.3.html">geopm_error<span class="s">(3)</span></a></strong> for a full description of the error numbers and how
to convert them to strings.</p>

<h2 id="COPYRIGHT">COPYRIGHT</h2>

<p>Copyright (c) 2015, 2016, 2017, 2018, Intel Corporation. All rights reserved.</p>

<h2 id="SEE-ALSO">SEE ALSO</h2>

<p><strong><a class="man-ref" href="geopm.7.html">geopm<span class="s">(7)</span></a></strong>,
<strong><a class="man-ref" href="geopm_agent_energy_efficient.7.html">geopm_agent_energy_efficient<span class="s">(7)</span></a></strong>,
<strong><a class="man-ref" href="geopm_agent_monitor.7.html">geopm_agent_monitor<span class="s">(7)</span></a></strong>,
<strong><a class="man-ref" href="geopm_agent_power_balancer.7.html">geopm_agent_power_balancer<span class="s">(7)</span></a></strong>,
<strong><a class="man-ref" href="geopm_agent_power_governor.7.html">geopm_agent_power_governor<span class="s">(7)</span></a></strong>,
<strong><a class="man-ref" href="geopm_agent_c.3.html">geopm_agent_c<span class="s">(3)</span></a></strong>,
<strong><a class="man-ref" href="geopm_error.3.html">geopm_error<span class="s">(3)</span></a></strong>,
<strong><a class="man-ref" href="geopmagent.1.html">geopmagent<span class="s">(1)</span></a></strong>,
<strong><a class="man-ref" href="geopmendpoint.1.html">geopmendpoint<span class="s">(1)</span></a></strong></p>


  <ol class='man-decor man-foot man foot'>
    <li class='tl'>Intel Corporation</li>
    <li class='tc'>December 2018</li>
    <li class='tr'>geopm_endpoint_c(3)</li>
  </ol>

  </div>
</body>
</html>
